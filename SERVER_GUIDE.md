# ๐ฅ๏ธ ะัะบะพะฒะพะดััะฒะพ ะฟะพ ัะฟัะฐะฒะปะตะฝะธั ัะตัะฒะตัะพะผ Sirius Group

> **ะกัะฐััั:** KEEP  
> **ะะฐะทะฝะฐัะตะฝะธะต:** ะะพะผะฟะปะตะบัะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ะทะฐะฟััะบั, ะฝะฐัััะพะนะบะต ะธ ััััะฐะฝะตะฝะธั ะฟัะพะฑะปะตะผ ัะตัะฒะตัะฐ  
> **ะะพะผั ะฟะพะปะตะทะฝะพ:** ะกะธััะตะผะฝัะผ ะฐะดะผะธะฝะธัััะฐัะพัะฐะผ, DevOps ะธะฝะถะตะฝะตัะฐะผ, ัะฐะทัะฐะฑะพััะธะบะฐะผ  
> **ะกะฒัะทะฐะฝะฝัะต ะดะพะบัะผะตะฝัั:** [DEPLOYMENT.md](DEPLOYMENT.md), [doc/ops_guide.md](doc/ops_guide.md), [doc/runbook_cursor.md](doc/runbook_cursor.md)

## ๐ ะัััััะน ััะฐัั ัะตัะฒะตัะฐ

### Windows (ัะตัะตะท PowerShell ัะบัะธะฟัั)
```powershell
# ะะธะฐะณะฝะพััะธะบะฐ ะธ ะธัะฟัะฐะฒะปะตะฝะธะต ะฟัะพะฑะปะตะผ
.\run_diagnosis.ps1

# ะะฐะฟััะบ ัะตัะฒะตัะฐ
.\start_server.ps1

# ะัะพะฒะตัะบะฐ ััะฐัััะฐ
.\scripts\win\serve_status.cmd

# ะััะฐะฝะพะฒะบะฐ ัะตัะฒะตัะฐ
.\scripts\win\serve_stop.cmd
```

### Linux/Mac
```bash
# ะะบัะธะฒะฐัะธั ะพะบััะถะตะฝะธั ะธ ะทะฐะฟััะบ
source venv/bin/activate
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000

# ะะฐะฟััะบ ะฒ ัะพะฝะต
nohup python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 > server.log 2>&1 &

# ะััะฐะฝะพะฒะบะฐ ัะตัะฒะตัะฐ
pkill -f uvicorn
```

## ๐ง ะะตัะตะฝะฝัะต ะฟัะพะฑะปะตะผั ัะตัะฒะตัะฐ

### โ ะัะฝะพะฒะฝะฐั ะฟัะพะฑะปะตะผะฐ: ะะตะฐะบัะธะฒะธัะพะฒะฐะฝะฝะพะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต

**ะกะธะผะฟัะพะผั:**
- `ModuleNotFoundError: No module named 'fastapi'`
- ะกะตัะฒะตั ะฟะฐะดะฐะตั ะฟัะธ ะทะฐะฟััะบะต
- ะะผะฟะพััั ะฝะต ัะฐะฑะพัะฐัั

**ะะตัะตะฝะธะต:**
```bash
# ะะกะะะะ ะฐะบัะธะฒะธััะนัะต venv ะฟะตัะตะด ัะฐะฑะพัะพะน
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# ะัะพะฒะตัััะต ะฐะบัะธะฒะฐัะธั
echo $VIRTUAL_ENV  # Linux/Mac
echo %VIRTUAL_ENV%  # Windows

# ะะพะปะถะฝะพ ะฑััั (venv) ะฒ ะฝะฐัะฐะปะต ัััะพะบะธ
(venv) PS D:\Sirius_sklad_new>
```

### โ ะัะพะฑะปะตะผั ั PowerShell

**ะัะพะฑะปะตะผะฐ:** `&&` ะฝะต ัะฐะฑะพัะฐะตั ะฒ PowerShell
```powershell
# โ ะะ ัะฐะฑะพัะฐะตั
command1 && command2

# โ ะะฐะฑะพัะฐะตั
command1; command2
```

**ะัะพะฑะปะตะผะฐ:** ะะฐะฒะธัะฐะฝะธั ะดะปะธัะตะปัะฝัั ะฟัะพัะตััะพะฒ
```powershell
# โ ะะ ะทะฐะฟััะบะฐะนัะต ัะตัะฒะตัั ัะตัะตะท run_terminal_cmd
python -m uvicorn app.main:app --reload

# โ ะัะฟะพะปัะทัะนัะต ะณะพัะพะฒัะต ัะบัะธะฟัั
.\start_server_stable.ps1
scripts\win\serve_dev.cmd
```

### โ ะัะพะฑะปะตะผั ั ะฟะพััะฐะผะธ

**ะัะพะฑะปะตะผะฐ:** Port 8000 already in use
```bash
# ะะฐะนัะธ ะฟัะพัะตัั ะฝะฐ ะฟะพััั
netstat -an | findstr :8000  # Windows
netstat -tlnp | grep :8000   # Linux

# ะฃะฑะธัั ะฟัะพัะตัั
taskkill /f /im python.exe   # Windows
pkill -f uvicorn             # Linux
```

**ะัะพะฑะปะตะผะฐ:** ะะฝะพะถะตััะฒะตะฝะฝัะต ะฟัะพัะตััั Python
```bash
# ะัะพะฒะตัะธัั ะฒัะต ะฟัะพัะตััั Python
tasklist | findstr python    # Windows
ps aux | grep python         # Linux

# ะฃะฑะธัั ะฒัะต ะฟัะพัะตััั Python (ะะกะขะะะะะะ!)
taskkill /f /im python.exe   # Windows
pkill python                 # Linux
```

## ๐๏ธ ะะฒัะพะผะฐัะธัะตัะบะธะต ะธะฝััััะผะตะฝัั ะธัะฟัะฐะฒะปะตะฝะธั

### 1. ะะธะฐะณะฝะพััะธัะตัะบะธะน ัะบัะธะฟั `diagnose_and_fix.py`

**ะงัะพ ะฟัะพะฒะตััะตั:**
- โ ะะบัะธะฒะฐัะธั ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั
- โ ะะฐะปะธัะธะต ะทะฐะฒะธัะธะผะพััะตะน
- โ ะกะพััะพัะฝะธะต ะฑะฐะทั ะดะฐะฝะฝัั
- โ ะะผะฟะพััั ะฟัะธะปะพะถะตะฝะธั
- โ ะะธะณัะฐัะธะธ Alembic

**ะงัะพ ะธัะฟัะฐะฒะปัะตั:**
- โ ะกะพะทะดะฐะตั .env ัะฐะนะป ะตัะปะธ ะพััััััะฒัะตั
- โ ะกะพะทะดะฐะตั ะฝะตะพะฑัะพะดะธะผัะต ะฟะฐะฟะบะธ
- โ ะัะธะผะตะฝัะตั ะผะธะณัะฐัะธะธ
- โ ะัะพะฒะตััะตั ะบะพััะตะบัะฝะพััั ะธะผะฟะพััะพะฒ

```python
# ะะฐะฟััะบ ะดะธะฐะณะฝะพััะธะบะธ
python diagnose_and_fix.py
```

### 2. PowerShell ัะบัะธะฟัั ะดะปั Windows

#### `run_diagnosis.ps1`
```powershell
# ะะพะปะฝะฐั ะดะธะฐะณะฝะพััะธะบะฐ ัะธััะตะผั
.\run_diagnosis.ps1
```

**ะงัะพ ะดะตะปะฐะตั:**
- ะัะพะฒะตััะตั Python ะธ ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
- ะัะพะฒะตััะตั ะทะฐะฒะธัะธะผะพััะธ
- ะขะตััะธััะตั ะธะผะฟะพััั
- ะัะพะฒะตััะตั ะฑะฐะทั ะดะฐะฝะฝัั
- ะะฐะฟััะบะฐะตั `diagnose_and_fix.py`

#### `start_server.ps1`
```powershell
# ะะฐะฟััะบ ัะตัะฒะตัะฐ ั ะฟัะพะฒะตัะบะฐะผะธ
.\start_server.ps1
```

**ะงัะพ ะดะตะปะฐะตั:**
- ะะบัะธะฒะธััะตั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
- ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั ะทะฐะฒะธัะธะผะพััะธ
- ะกะพะทะดะฐะตั .env ัะฐะนะป
- ะัะธะผะตะฝัะตั ะผะธะณัะฐัะธะธ
- ะะฐะฟััะบะฐะตั uvicorn ัะตัะฒะตั

## ๐ ะฃะฟัะฐะฒะปะตะฝะธะต ัะตัะฒะธัะพะผ

### ะะปั systemd (Linux)

#### ะกะพะทะดะฐะฝะธะต ัะตัะฒะธัะฐ
```bash
sudo nano /etc/systemd/system/sirius.service
```

```ini
[Unit]
Description=Sirius Group Warehouse System
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/path/to/sirius_sklad_new
Environment=PATH=/path/to/sirius_sklad_new/venv/bin
ExecStart=/path/to/sirius_sklad_new/venv/bin/python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### ะฃะฟัะฐะฒะปะตะฝะธะต ัะตัะฒะธัะพะผ
```bash
# ะะบัะธะฒะฐัะธั
sudo systemctl daemon-reload
sudo systemctl enable sirius
sudo systemctl start sirius

# ะกัะฐััั ะธ ะปะพะณะธ
sudo systemctl status sirius
sudo journalctl -u sirius -f

# ะฃะฟัะฐะฒะปะตะฝะธะต
sudo systemctl stop sirius
sudo systemctl restart sirius
```

### ะะปั Windows (ัะตัะตะท ัะบัะธะฟัั)

#### ะะฐะฟััะบ ัะตัะฒะตัะฐ
```cmd
# ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั
scripts\win\make.bat up      # ะะฐะฟััะบ ัะตัะฒะตัะฐ
scripts\win\make.bat down    # ะััะฐะฝะพะฒะบะฐ ัะตัะฒะตัะฐ
scripts\win\make.bat status  # ะัะพะฒะตัะบะฐ ััะฐัััะฐ
scripts\win\make.bat logs    # ะัะพัะผะพัั ะปะพะณะพะฒ
```

#### ะคะฐะนะปั ัะฟัะฐะฒะปะตะฝะธั
- `logs\uvicorn-dev.pid` - PID ัะฐะนะป ะฟัะพัะตััะฐ
- `logs\uvicorn-dev.log` - ะพัะฝะพะฒะฝัะต ะปะพะณะธ ัะตัะฒะตัะฐ
- `logs\uvicorn-dev.out` - stdout ัะตัะฒะตัะฐ
- `logs\uvicorn-dev.err` - stderr ัะตัะฒะตัะฐ

## ๐ ะะธะฐะณะฝะพััะธะบะฐ ะธ ะผะพะฝะธัะพัะธะฝะณ

### ะัะพะฒะตัะบะฐ ััะฐัััะฐ ัะตัะฒะตัะฐ

#### HTTP ะฟัะพะฒะตัะบะธ
```bash
# ะัะฝะพะฒะฝะฐั ัััะฐะฝะธัะฐ
curl http://localhost:8000/

# Health endpoint
curl http://localhost:8000/health

# API ะดะพะบัะผะตะฝัะฐัะธั
curl http://localhost:8000/docs

# ะก ะดะตัะฐะปัะฝัะผ ะฒัะฒะพะดะพะผ
curl -v http://localhost:8000/
```

#### ะัะพะฒะตัะบะฐ ะฟัะพัะตััะพะฒ
```bash
# ะัะพัะตััั Python
tasklist | findstr python    # Windows
ps aux | grep python         # Linux

# ะัะพัะตััั uvicorn
tasklist | findstr uvicorn   # Windows
ps aux | grep uvicorn        # Linux

# ะะฐะฝัััะต ะฟะพััั
netstat -an | findstr :8000  # Windows
netstat -tlnp | grep :8000   # Linux
```

### ะะพะณะธ ะธ ะพัะปะฐะดะบะฐ

#### ะัะพัะผะพัั ะปะพะณะพะฒ
```bash
# Windows
type logs\uvicorn-dev.log
Get-Content logs\uvicorn-dev.log -Tail 10

# Linux
tail -f server.log
journalctl -u sirius -f
```

#### ะฃัะพะฒะฝะธ ะปะพะณะธัะพะฒะฐะฝะธั
- **INFO** - ะฝะพัะผะฐะปัะฝะฐั ัะฐะฑะพัะฐ
- **WARNING** - ะฟัะตะดัะฟัะตะถะดะตะฝะธั
- **ERROR** - ะพัะธะฑะบะธ
- **DEBUG** - ะพัะปะฐะดะพัะฝะฐั ะธะฝัะพัะผะฐัะธั

## ๐จ ะขะธะฟะธัะฝัะต ะฟัะพะฑะปะตะผั ะธ ัะตัะตะฝะธั

### 1. ะกะตัะฒะตั ะฝะต ะทะฐะฟััะบะฐะตััั

**ะะธะฐะณะฝะพััะธะบะฐ:**
```bash
# ะัะพะฒะตัะบะฐ ะปะพะณะพะฒ
tail -f server.log

# ะัะพะฒะตัะบะฐ ะฟะพััะฐ
netstat -an | findstr :8000

# ะัะพะฒะตัะบะฐ ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั
which python
pip list | grep fastapi
```

**ะะตัะตะฝะธั:**
1. ะะบัะธะฒะธัะพะฒะฐัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
2. ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ: `pip install -r requirements.txt`
3. ะัะฒะพะฑะพะดะธัั ะฟะพัั 8000
4. ะัะพะฒะตัะธัั .env ัะฐะนะป

### 2. ะกะตัะฒะตั ะทะฐะฟััะบะฐะตััั, ะฝะพ ะฝะต ะพัะฒะตัะฐะตั

**ะะธะฐะณะฝะพััะธะบะฐ:**
```bash
# ะัะพะฒะตัะบะฐ ะฟัะธะฒัะทะบะธ
netstat -an | findstr :8000

# ะัะพะฒะตัะบะฐ ะฟัะพัะตััะฐ
ps aux | grep uvicorn
```

**ะะตัะตะฝะธั:**
1. ะัะพะฒะตัะธัั ะฟะฐัะฐะผะตัั `--host 0.0.0.0`
2. ะัะพะฒะตัะธัั ัะฐะนัะฒะพะป
3. ะัะพะฒะตัะธัั ะฟัะฐะฒะฐ ะดะพัััะฟะฐ

### 3. ะัะธะฑะบะธ ะธะผะฟะพััะฐ ะผะพะดัะปะตะน

**ะะธะฐะณะฝะพััะธะบะฐ:**
```python
# ะัะพะฒะตัะบะฐ ะธะผะฟะพััะพะฒ
python -c "from app.main import app; print('OK')"
python -c "import fastapi; print('OK')"
```

**ะะตัะตะฝะธั:**
1. ะะบัะธะฒะธัะพะฒะฐัั venv
2. ะะตัะตัััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
3. ะัะพะฒะตัะธัั PYTHONPATH

### 4. ะัะธะฑะบะธ ะฑะฐะทั ะดะฐะฝะฝัั

**ะะธะฐะณะฝะพััะธะบะฐ:**
```bash
# ะัะพะฒะตัะบะฐ ัะฐะนะปะฐ ะะ
ls -la sirius_sklad.db

# ะัะพะฒะตัะบะฐ ะผะธะณัะฐัะธะน
alembic current
alembic history
```

**ะะตัะตะฝะธั:**
1. ะัะธะผะตะฝะธัั ะผะธะณัะฐัะธะธ: `alembic upgrade head`
2. ะัะพะฒะตัะธัั ะฟัะฐะฒะฐ ะดะพัััะฟะฐ ะบ ัะฐะนะปั ะะ
3. ะะตัะตัะพะทะดะฐัั ะะ ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ

### 5. ะัะพะฑะปะตะผั ั ะทะฐะฒะธัะธะผะพัััะผะธ

**ะะธะฐะณะฝะพััะธะบะฐ:**
```bash
# ะัะพะฒะตัะบะฐ ัััะฐะฝะพะฒะปะตะฝะฝัั ะฟะฐะบะตัะพะฒ
pip list
pip check

# ะัะพะฒะตัะบะฐ requirements
pip install --dry-run -r requirements.txt
```

**ะะตัะตะฝะธั:**
1. ะะฑะฝะพะฒะธัั pip: `pip install --upgrade pip`
2. ะะตัะตัััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ: `pip install -r requirements.txt --force-reinstall`
3. ะะตัะตัะพะทะดะฐัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต

## ๐ก ะัััะธะต ะฟัะฐะบัะธะบะธ

### ะะปั ัะฐะทัะฐะฑะพัะบะธ
1. **ะะกะะะะ** ะฐะบัะธะฒะธััะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
2. **ะะะะะะะ** ะฝะต ะทะฐะฟััะบะฐะนัะต ัะตัะฒะตัั ัะตัะตะท Cursor `run_terminal_cmd`
3. ะัะฟะพะปัะทัะนัะต ะฐะฒัะพะผะฐัะธัะตัะบะธะต ัะบัะธะฟัั
4. ะะตะณัะปััะฝะพ ะฟัะพะฒะตััะนัะต ะปะพะณะธ
5. ะะตะปะฐะนัะต ัะตะทะตัะฒะฝัะต ะบะพะฟะธะธ ะะ

### ะะปั ะฟัะพะดะฐะบัะตะฝะฐ
1. ะัะฟะพะปัะทัะนัะต systemd ะดะปั ะฐะฒัะพะทะฐะฟััะบะฐ
2. ะะฐัััะพะนัะต ะผะพะฝะธัะพัะธะฝะณ
3. ะะพัะฐัะธั ะปะพะณะพะฒ
4. ะะตะณัะปััะฝัะต ะฑัะบะฐะฟั
5. ะะฑะฝะพะฒะปะตะฝะธั ะฑะตะทะพะฟะฐัะฝะพััะธ

### ะะปั ะพัะปะฐะดะบะธ
1. ะะบะปััะธัะต DEBUG ัะตะถะธะผ ัะพะปัะบะพ ะดะปั ัะฐะทัะฐะฑะพัะบะธ
2. ะัะฟะพะปัะทัะนัะต ะดะตัะฐะปัะฝัะต ะปะพะณะธ
3. ะะพะฝะธัะพัััะต ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั
4. ะขะตััะธััะนัะต ะฝะฐ ัะฐะทะฝัั ะพะบััะถะตะฝะธัั

## ๐ ะงะตะบ-ะปะธัั ะทะฐะฟััะบะฐ ัะตัะฒะตัะฐ

### ะะตัะตะด ะทะฐะฟััะบะพะผ:
- [ ] ะะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต ะฐะบัะธะฒะธัะพะฒะฐะฝะพ `(venv)`
- [ ] ะะฐะฒะธัะธะผะพััะธ ัััะฐะฝะพะฒะปะตะฝั `pip list | grep fastapi`
- [ ] .env ัะฐะนะป ัะพะทะดะฐะฝ ะธ ะฝะฐัััะพะตะฝ
- [ ] ะะธะณัะฐัะธะธ ะฟัะธะผะตะฝะตะฝั `alembic current`
- [ ] ะะพัั 8000 ัะฒะพะฑะพะดะตะฝ `netstat -an | findstr :8000`

### ะะพัะปะต ะทะฐะฟััะบะฐ:
- [ ] ะกะตัะฒะตั ะพัะฒะตัะฐะตั `curl http://localhost:8000/`
- [ ] ะะตั ะพัะธะฑะพะบ ะฒ ะปะพะณะฐั
- [ ] API ะดะพะบัะผะตะฝัะฐัะธั ะดะพัััะฟะฝะฐ `/docs`
- [ ] Health endpoint ัะฐะฑะพัะฐะตั `/health`
- [ ] ะัะพัะตัั ะทะฐะฟะธัะฐะฝ ะฒ PID ัะฐะนะป

### ะัะธ ะฟัะพะฑะปะตะผะฐั:
- [ ] ะัะพะฒะตัะธัั ะปะพะณะธ ัะตัะฒะตัะฐ
- [ ] ะัะพะฒะตัะธัั ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
- [ ] ะะฐะฟัััะธัั ะดะธะฐะณะฝะพััะธะบั `python diagnose_and_fix.py`
- [ ] ะะตัะตะทะฐะฟัััะธัั ัะตัะฒะตั
- [ ] ะะฑัะฐัะธัััั ะบ ะดะพะบัะผะตะฝัะฐัะธะธ

---

> **๐ก ะััะพัะฝะธะบะธ:** ะญัะพั ะดะพะบัะผะตะฝั ะพะฑัะตะดะธะฝัะตั ะธะฝัะพัะผะฐัะธั ะธะท SERVER_STARTUP_GUIDE.md, SERVER_INSTRUCTIONS.md, SERVER_ISSUES_SOLVED.md  
> **๐ ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 25 ัะตะฝััะฑัั 2025  
> **๐ง ะกัะฐััั:** ะัะต ะบัะธัะธัะตัะบะธะต ะฟัะพะฑะปะตะผั ัะตัะตะฝั
